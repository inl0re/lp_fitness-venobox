(function(A){var L,N,O,d,j,v,D,i,w,a,M,u,f,n,G,p,z,s,g,k,e,m,I,q,y,F,t,K,P,c,E,x,b;A.fn.extend({venobox:function(Q){var S={framewidth:"",frameheight:"",border:"0",bgcolor:"#fff",titleattr:"title",numeratio:false,infinigall:false,overlayclose:true};var R=A.extend(S,Q);return this.each(function(){var T=A(this);if(T.data("venobox")){return true}T.addClass("vbox-item");T.data("framewidth",R.framewidth);T.data("frameheight",R.frameheight);T.data("border",R.border);T.data("bgcolor",R.bgcolor);T.data("numeratio",R.numeratio);T.data("infinigall",R.infinigall);T.data("overlayclose",R.overlayclose);T.data("venobox",true);T.click(function(X){X.stopPropagation();X.preventDefault();T=A(this);m=T.data("overlay");G=T.data("framewidth");p=T.data("frameheight");L=T.data("autoplay")||false;j=T.data("border");N=T.data("bgcolor");x=false;b=false;g=false;w=T.data("href")||T.attr("href");f=T.data("css")||"";A("body").addClass("vbox-open");v='<div class="vbox-overlay '+f+'" style="background:'+m+'"><div class="vbox-preloader">Loading...</div><div class="vbox-container"><div class="vbox-content"></div></div><div class="vbox-title"></div><div class="vbox-num">0/0</div><div class="vbox-close">X</div><div class="vbox-next">next</div><div class="vbox-prev">prev</div></div>';A("body").append(v);I=A(".vbox-overlay");D=A(".vbox-container");i=A(".vbox-content");O=A(".vbox-num");d=A(".vbox-title");i.html("");i.css("opacity","0");Z();I.css("min-height",A(window).outerHeight());I.animate({opacity:1},250,function(){if(T.data("type")=="iframe"){h()}else{if(T.data("type")=="inline"){l()}else{if(T.data("type")=="ajax"){J()}else{if(T.data("type")=="vimeo"){o(L)}else{if(T.data("type")=="youtube"){H(L)}else{i.html('<img src="'+w+'">');B()}}}}}});function Z(){F=T.data("gall");e=T.data("numeratio");z=T.data("infinigall");s=A('.vbox-item[data-gall="'+F+'"]');if(s.length>1&&e===true){O.html(s.index(T)+1+" / "+s.length);O.show()}else{O.hide()}t=s.eq(s.index(T)+1);K=s.eq(s.index(T)-1);if(T.attr(R.titleattr)){y=T.attr(R.titleattr);d.hide()}else{y="";d.hide()}if(s.length>1&&z===true){x=true;b=true;if(t.length<1){t=s.eq(0)}if(s.index(T)<1){K=s.eq(s.index(s.length))}}else{if(t.length>0){A(".vbox-next").css("display","block");x=true}else{A(".vbox-next").css("display","none");x=false}if(s.index(T)>0){A(".vbox-prev").css("display","block");b=true}else{A(".vbox-prev").css("display","none");b=false}}}var V={prev:function(){if(g){return}else{g=true}m=K.data("overlay");G=K.data("framewidth");p=K.data("frameheight");j=K.data("border");N=K.data("bgcolor");w=K.data("href")||K.attr("href");L=K.data("autoplay");if(K.attr(R.titleattr)){y=K.attr(R.titleattr)}else{y=""}if(m===undefined){m=""}i.animate({opacity:0},500,function(){I.css("background",m);if(K.data("type")=="iframe"){h()}else{if(K.data("type")=="inline"){l()}else{if(K.data("type")=="ajax"){J()}else{if(K.data("type")=="youtube"){H(L)}else{if(K.data("type")=="vimeo"){o(L)}else{i.html('<img src="'+w+'">');B()}}}}}T=K;Z();g=false})},next:function(){if(g){return}else{g=true}m=t.data("overlay");G=t.data("framewidth");p=t.data("frameheight");j=t.data("border");N=t.data("bgcolor");w=t.data("href")||t.attr("href");L=t.data("autoplay");if(t.attr(R.titleattr)){y=t.attr(R.titleattr)}else{y=""}if(m===undefined){m=""}i.animate({opacity:0},500,function(){I.css("background",m);if(t.data("type")=="iframe"){h()}else{if(t.data("type")=="inline"){l()}else{if(t.data("type")=="ajax"){J()}else{if(t.data("type")=="youtube"){H(L)}else{if(t.data("type")=="vimeo"){o(L)}else{i.html('<img src="'+w+'">');B()}}}}}T=t;Z();g=false})}};A("body").keydown(function(aa){if(aa.keyCode==37&&b==true){V.prev()}if(aa.keyCode==39&&x==true){V.next()}});A(".vbox-prev").click(function(){V.prev()});A(".vbox-next").click(function(){V.next()});function Y(aa){if(aa.keyCode===27){W()}}function W(){A("body").removeClass("vbox-open");A("body").unbind("keydown",Y);I.animate({opacity:0},500,function(){I.remove();g=false;T.focus()})}var U=".vbox-close, .vbox-overlay";if(!T.data("overlayclose")){U=".vbox-close"}A(U).click(function(aa){a=".figlio";u=".vbox-prev";M=".vbox-next";n=".figlio *";if(!A(aa.target).is(a)&&!A(aa.target).is(M)&&!A(aa.target).is(u)&&!A(aa.target).is(n)){W()}});A("body").keydown(Y);return false})})}});function J(){A.ajax({url:w,cache:false}).done(function(Q){i.html('<div class="vbox-inline">'+Q+"</div>");r(true)}).fail(function(){i.html('<div class="vbox-inline"><p>Error retrieving contents, please retry</div>');r(true)})}function h(){i.html('<iframe class="venoframe" src="'+w+'"></iframe>');r()}function o(S){var T=w.split("/");var R=T[T.length-1];var Q=S?"?autoplay=1":"";i.html('<iframe class="venoframe" webkitallowfullscreen mozallowfullscreen allowfullscreen frameborder="0" src="//player.vimeo.com/video/'+R+Q+'"></iframe>');r()}function H(S){var T=w.split("/");var R=T[T.length-1];var Q=S?"?autoplay=1":"";i.html('<iframe class="venoframe" webkitallowfullscreen mozallowfullscreen allowfullscreen src="//www.youtube.com/embed/'+R+Q+'"></iframe>');r()}function l(){i.html('<div class="vbox-inline">'+A(w).html()+"</div>");r()}function B(){q=A(".vbox-content").find("img");q.one("load",function(){r()}).each(function(){if(this.complete){A(this).load()}})}function r(){d.html(y);if(y){A(".vbox-content .sign-for-training h1").html(y)}i.find(">:first-child").addClass("figlio");A(".figlio").css("width",G).css("height",p).css("padding",j).css("background",N);E=i.outerHeight();c=A(window).height();if(E+80<c){k=(c-E)/2;i.css("margin-top",k);i.css("margin-bottom",k)}else{i.css("margin-top","40px");i.css("margin-bottom","40px")}i.animate({opacity:"1"},"slow")}function C(){if(A(".vbox-content").length){E=i.height();c=A(window).height();if(E+80<c){k=(c-E)/2;i.css("margin-top",k);i.css("margin-bottom",k)}else{i.css("margin-top","40px");i.css("margin-bottom","40px")}}}A(window).resize(function(){C()})})(jQuery);